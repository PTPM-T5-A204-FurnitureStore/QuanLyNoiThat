@model IEnumerable<WebsiteNoiThat.Models.SanPham>


<div class="flex grid grid-cols-5 ">

	<form id="filter-form">
		<div class="flex flex-col">
			<!-- Trường dropdown Giá -->
			<div class="flex">
				<p>Giá:</p>
				<div class="relative">
					<select id="sortOrder" class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500">
						<option>Please select one</option>
						<option value="asc">Price (Ascending)</option>
						<option value="desc">Price (Descending)</option>
					</select>
					<div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
						<svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M7 7l3-3 3 3m0 6l-3 3-3-3"></path></svg>
					</div>
				</div>
			</div>

			<!-- Trường dropdown Chất liệu -->
			<div class="flex mt-2">
				<p>Chất liệu: </p>
				<div class="relative">
					<select id="maChatLieu" class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500">
						<option value="">All Materials</option>
					</select>
					<div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
						<svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M7 7l3-3 3 3m0 6l-3 3-3-3"></path></svg>
					</div>
				</div>
			</div>

			<!-- Trường dropdown Xuất xứ -->
			<div class="flex mt-2">
				<p>Xuất xứ: </p>
				<div class="relative">
					<select id="maXuatXu" class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500">
						<option value="">All Origins</option>
					</select>
					<div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
						<svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M7 7l3-3 3 3m0 6l-3 3-3-3"></path></svg>
					</div>
				</div>
			</div>
		</div>

		<!-- Nút để thực hiện việc lọc -->
		<button type="submit" class="bg-black text-white font-bold py-2 px-4 rounded mt-4 ml-4" id="applyButton">
			Áp dụng
		</button>
	</form>



	<div id="product-list" class=" col-span-3 px-2 flex grid grid-cols-3 gap-[10px]">
		@{
			foreach (var item in Model)
			{
				//<a  href="@Url.Action("ProductByCategory","Home", new{ @categoryId=item.MaSP})">
				<div class="product-item shadow-lg bg-white border-2 h-[360px] w-full rounded-lg p-[10px]">
					<img src="~/Images/logon1.jpeg" class="w-full h-[200PX]    rounded-lg">
					<div class="flex items-center ">
						<button id="favoriteButton1" class="ml-auto mr-[8px] text-black hover:text-red-500  translate-y-6 ">
							<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
								<path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
							</svg>
						</button>
					</div>
					<div class="font-Raleway text-[15px] translate-x-6">
						@item.TenSanPham
					</div>
					<div class="flex">
						<div class=" font-bold text-red-200 translate-x-6 ">@item.GiaBan</div>
						<div class=" mt-[5px] ml-[10px] text-[10px] font-bold red-text translate-x-6  line-through">@item.GiaBan</div>//
					</div>

					<div class="flex ml-6">
						<div class="flex items-center ">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3  text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
							</svg>
							<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
							</svg>
							<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
							</svg>
							<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
							</svg>
							<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
							</svg>

							<div class="text-xs text-gray-500 ml-3">(26)</div>
						</div>

						@{
							var mausac = @item.MauSac;
							var colors = mausac.Split(", ");

						}

						<div class="ml-auto mr-[30px]   flex -space-x-2  ml-auto">
							@foreach (var color in colors)
							{
								<div class="translate-x-1 rounded-tr-lg-[2px] border-slate-600  inline-block ring-2 ring-white  h-4 w-4 border-2" style="background-color: @color"></div>

							}
					</div>

					</div>



					<button class="buy-button text-center  h-[30px]   px-5 w-full">See More</button>
				</div>
				//</a>

			}
		}
	</div>


</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
	var urlParams = new URLSearchParams(window.location.search);
	var idLoaiHang = urlParams.get("idLoaiHang");
	console.log(idLoaiHang);// kiểm tra id loại hàng



	// Lắng nghe sự kiện khi người dùng nhấn nút "Apply"
	$('#applyButton').click(function (e) {
		e.preventDefault(); // Ngăn chặn gửi form mặc định
		applyFilter(); // Gọi hàm applyFilter() khi người dùng nhấn nút "Apply"
	});

	function applyFilter() {
		var minPrice = $('#minPrice').val();
		var maxPrice = $('#maxPrice').val();
		var maChatLieu = $('#maChatLieu').val() === 'All Materials' ? null : $('#maChatLieu').val();
		var maXuatXu = $('#maXuatXu').val() === 'All Origins' ? null : $('#maXuatXu').val();
		var sortOrder = $('#sortOrder').val();

		var url = "https://localhost:7053/api/SanPham/GetSanPhamByFilters/Filter?idloai=" + idLoaiHang + '&';

		if (sortOrder) {
			url += '&sortOrder=' + sortOrder;
		}
		if (minPrice) {
			url += '&minPrice=' + minPrice;
		}
		if (maxPrice) {
			url += '&maxPrice=' + maxPrice;
		}
		if (maChatLieu) {
			url += '&maChatLieu=' + maChatLieu;
		}
		if (maXuatXu) {
			url += '&maXuatXu=' + maXuatXu;
		}

		// Gửi yêu cầu AJAX với URL được tạo
		$.ajax({
			type: 'GET',
			url: url,
			success: function (data) {
				$('#product-list').empty();
				$.each(data, function (index, sanPham) {
					// Tạo sản phẩm HTML từ dữ liệu JSON
					var productHtml = `
						 <div class="product-item shadow-lg bg-white border-2 h-[360px] w-full rounded-lg p-[10px]">
						<img src="/Images/logon1.jpeg" class="w-full h-[200PX] rounded-lg">
						<div class="flex items-center">
								<button id="favoriteButton1" class="ml-auto mr-[8px] text-black hover:text-red-500  translate-y-6 ">
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
									<path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
								</svg>
							</button>
						</div>
						<div class="font-Raleway text-[15px] translate-x-6">
							${sanPham.tenSanPham}
						</div>
						<div class="flex">
							<div class="font-bold text-red-200 translate-x-6 ">
								${sanPham.giaBan}
							</div>
							<div class="mt-[5px] ml-[10px] text-[10px] font-bold red-text translate-x-6  line-through">
								${sanPham.giaBan}
							</div>
						</div>
								<div class="flex ml-6">
							<div class="flex items-center ">
								<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3  text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
								</svg>
								<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
								</svg>
								<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
								</svg>
								<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
								</svg>
								<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-yellow-300" fill="yellow" viewBox="0 0 24 24" stroke="currentColor">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z" />
								</svg>

								<div class="text-xs text-gray-500 ml-3">(26)</div>
							</div>
						<!-- Hiển thị màu sắc từ dữ liệu JSON -->
						<div class="ml-auto mr-[30px]   flex -space-x-2  ml-auto">
							${sanPham.mauSac.split(', ').map(color => `
								<div class="translate-x-1 rounded-tr-lg-[2px] border-slate-600  inline-block ring-2 ring-white  h-4 w-4 border-2" style="background-color: ${color}"></div>
							`).join('')}
						</div>

						</div>
						<button class="buy-button text-center  h-[30px]   px-5 w-full">See More</button>
					</div>
				`;

					// Thêm sản phẩm vào danh sách
					$('#product-list').append(productHtml);
				});
			},
			error: function () {
				alert('Có lỗi xảy ra khi lọc sản phẩm.');
			}
		});
	}
</script>
<script>
	// Sử dụng jQuery để gửi yêu cầu AJAX đến API
	$.ajax({
		url: 'https://localhost:7053/api/ChatLieu/GetChatLieu',
		method: 'GET',
		success: function (data) {
			// Lặp qua dữ liệu API và thêm từng thành phần vào thẻ select
			$.each(data, function (index, chatLieu) {
				$('#maChatLieu').append($('<option>', {
					value: chatLieu.maChatLieu,
					text: chatLieu.tenChatLieu
				}));
			});
		},
		error: function (error) {
			console.log('Error:', error);
		}
	});
</script>
<script>
	// Sử dụng jQuery để gửi yêu cầu AJAX đến API
	$.ajax({
		url: 'https://localhost:7053/api/XuatXu/GetXuatXu',
		method: 'GET',
		success: function (data) {
			// Lặp qua dữ liệu API và thêm từng thành phần vào thẻ select
			$.each(data, function (index, xuatXu) {
				$('#maXuatXu').append($('<option>', {
					value: xuatXu.maXuatXu,
					text: xuatXu.tenXuatXu
				}));
			});
		},
		error: function (error) {
			console.log('Error:', error);
		}
	});
</script>